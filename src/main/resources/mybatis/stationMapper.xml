<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cs.dao.mapper.StationMapper">
    <resultMap type="com.cs.dao.model.StationPO" id="station">
        <result column="id" property="id" jdbcType="INTEGER"/>
        <result column="lat" property="lat" jdbcType="DOUBLE"/>
        <result column="lng" property="lng" jdbcType="DOUBLE"/>
        <result column="info" property="info" jdbcType="VARCHAR"/>
        <result column="tid" property="tid" jdbcType="INTEGER"/>
    </resultMap>
    <insert id="insertStations" parameterType="java.util.List">
        INSERT INTO
        	STATION(lat,lng,info,tid)
        VALUES
        <foreach collection="list" item = "item" index="index" separator=",">
        	(#{item.lat},#{item.lng},#{item.info},#{item.tid})
        </foreach>
    </insert>
    <delete id="delStations" parameterType = "Integer">
        DELETE FROM
    		STATION
    	where tid = #{0}
    </delete>
    <select id="searchStations" parameterType="HashMap" resultMap="station">
        SELECT  lat,lng,info
        	FROM STATION
        <where>
           tid = #{tid} and lat &gt;= #{minlat} and lat &lt;= #{maxlat} and lng &gt;= #{minlng} and lng &lt;= #{maxlng}
        </where>
        order by lng,lat
    </select>
    <insert id="insertTable" parameterType="com.cs.dao.model.StationTablePO">
    	INSERT INTO
    		STATIONTABLE(info,uid,count)
    	VALUES(#{info},#{uid},0)
    </insert>
    <update id="updateTable" parameterType="com.cs.dao.model.StationTablePO">
    	UPDATE STATIONTABLE
    	<set>
            <if test="info!=null and info!=''">info=#{info},</if>
            <if test="count!=null and count!=-1">count=#{count},</if>
        </set>
        where id = #{id}
    </update>
    <delete id="deleteTable" parameterType="HashMap">
    	DELETE FROM
    		STATIONTABLE
    	<where>
    		<if test="id!=null and id != '-1'">id = #{id}</if>
    		<if test="uid!=null and uid != '-1'">and uid = #{uid}</if>
    	</where>
    </delete>
    <select id="getTables" parameterType="HashMap" resultType="com.cs.dao.model.StationTablePO">
    	SELECT * FROM
    		STATIONTABLE
    	<where>
    		<if test="uid!=null and uid != '-1'">uid = #{uid}</if>
    		<if test="info!=null and into != ''">and info like '%${info}%'</if>
    	</where>
    	ORDER BY id desc
	   		LIMIT #{offset},#{limit}
    </select>
</mapper>